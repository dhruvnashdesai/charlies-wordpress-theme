// ==========================================================================
// Animations & Polish - Charlie's Theme
// Premium micro-interactions and effects
// ==========================================================================

@use 'variables' as *;
@use 'mixins' as *;

// --------------------------------------------------------------------------
// Scroll Reveal Animations
// --------------------------------------------------------------------------

// Base class for animated elements
[data-animate] {
	opacity: 0;
	transform: translateY(20px);
	transition: opacity 0.6s ease, transform 0.6s ease;

	&.is-visible {
		opacity: 1;
		transform: translateY(0);
	}
}

// Stagger children animation
.animate-stagger {
	> * {
		opacity: 0;
		transform: translateY(20px);
		transition: opacity 0.4s ease, transform 0.4s ease;
	}

	&.is-visible > * {
		opacity: 1;
		transform: translateY(0);

		@for $i from 1 through 12 {
			&:nth-child(#{$i}) {
				transition-delay: #{$i * 0.05}s;
			}
		}
	}
}

// Fade in only
.animate-fade {
	opacity: 0;
	transition: opacity 0.6s ease;

	&.is-visible {
		opacity: 1;
	}
}

// Scale up
.animate-scale {
	opacity: 0;
	transform: scale(0.95);
	transition: opacity 0.5s ease, transform 0.5s ease;

	&.is-visible {
		opacity: 1;
		transform: scale(1);
	}
}

// --------------------------------------------------------------------------
// Enhanced Hover States
// --------------------------------------------------------------------------

// Links with underline animation
.link-hover {
	position: relative;
	display: inline-block;

	&::after {
		content: '';
		position: absolute;
		bottom: -2px;
		left: 0;
		width: 0;
		height: 2px;
		background-color: $color-accent;
		transition: width $transition-base;
	}

	&:hover::after {
		width: 100%;
	}
}

// Button press effect
.btn,
.button,
.product-card__btn {
	&:active {
		transform: scale(0.98);
	}
}

// Card lift on hover (enhanced)
.product-card,
.benefit-card {
	&:hover {
		transform: translateY(-6px);
	}
}

// Image zoom container
.image-zoom {
	overflow: hidden;

	img {
		transition: transform 0.5s ease;
	}

	&:hover img {
		transform: scale(1.08);
	}
}

// --------------------------------------------------------------------------
// Loading States
// --------------------------------------------------------------------------

// Skeleton loader
.skeleton {
	position: relative;
	overflow: hidden;
	background-color: $color-bg-card;

	&::after {
		content: '';
		position: absolute;
		top: 0;
		left: 0;
		right: 0;
		bottom: 0;
		background: linear-gradient(
			90deg,
			transparent 0%,
			rgba($color-white, 0.05) 50%,
			transparent 100%
		);
		animation: shimmer 1.5s infinite;
	}
}

@keyframes shimmer {
	0% {
		transform: translateX(-100%);
	}
	100% {
		transform: translateX(100%);
	}
}

// Button loading state
.btn-loading {
	position: relative;
	color: transparent;
	pointer-events: none;

	&::after {
		content: '';
		position: absolute;
		top: 50%;
		left: 50%;
		width: 20px;
		height: 20px;
		margin: -10px 0 0 -10px;
		border: 2px solid rgba($color-white, 0.3);
		border-top-color: $color-white;
		border-radius: 50%;
		animation: spin 0.6s linear infinite;
	}
}

// --------------------------------------------------------------------------
// Cart Count Animation
// --------------------------------------------------------------------------

.charlies-cart-count {
	transition: transform $transition-fast;

	&.bump {
		animation: bump 0.3s ease;
	}
}

@keyframes bump {
	0%, 100% {
		transform: scale(1);
	}
	50% {
		transform: scale(1.3);
	}
}

// --------------------------------------------------------------------------
// Back to Top Button
// --------------------------------------------------------------------------

.back-to-top {
	position: fixed;
	bottom: $spacing-6;
	right: $spacing-6;
	z-index: $z-fixed;
	display: flex;
	align-items: center;
	justify-content: center;
	width: 48px;
	height: 48px;
	background-color: $color-accent;
	color: $color-white;
	border: none;
	border-radius: $border-radius-full;
	cursor: pointer;
	opacity: 0;
	visibility: hidden;
	transform: translateY(20px);
	transition: all $transition-base;
	box-shadow: $shadow-lg;

	&:hover {
		background-color: $color-accent-hover;
		transform: translateY(-2px);
	}

	&.is-visible {
		opacity: 1;
		visibility: visible;
		transform: translateY(0);
	}

	svg {
		width: 24px;
		height: 24px;
	}
}

// --------------------------------------------------------------------------
// Page Transitions
// --------------------------------------------------------------------------

.site-main {
	animation: pageIn 0.4s ease;
}

@keyframes pageIn {
	from {
		opacity: 0;
	}
	to {
		opacity: 1;
	}
}

// --------------------------------------------------------------------------
// Focus Styles (Enhanced)
// --------------------------------------------------------------------------

// Custom focus ring
*:focus-visible {
	outline: 2px solid $color-accent;
	outline-offset: 3px;
}

// Input focus glow
input:focus,
select:focus,
textarea:focus {
	box-shadow: 0 0 0 3px rgba($color-accent, 0.2);
}

// --------------------------------------------------------------------------
// Smooth Scroll
// --------------------------------------------------------------------------

html {
	scroll-behavior: smooth;

	@media (prefers-reduced-motion: reduce) {
		scroll-behavior: auto;
	}
}

// --------------------------------------------------------------------------
// Selection
// --------------------------------------------------------------------------

::selection {
	background-color: $color-accent;
	color: $color-white;
}

// --------------------------------------------------------------------------
// Reduced Motion
// --------------------------------------------------------------------------

@media (prefers-reduced-motion: reduce) {
	*,
	*::before,
	*::after {
		animation-duration: 0.01ms !important;
		animation-iteration-count: 1 !important;
		transition-duration: 0.01ms !important;
	}

	[data-animate],
	.animate-stagger > *,
	.animate-fade,
	.animate-scale {
		opacity: 1;
		transform: none;
	}
}
